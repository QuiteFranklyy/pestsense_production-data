{"device":"DESKTOP","widgets":{"Container#0":{"t":"Container","lX":5,"lY":10,"sX":7.7,"sY":9.25,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"32.39%","height":"74.96%","x":"0.2%","y":"0.9%"},"ver":"190104c190915","z":"110","dis":false,"a":{"title":"Manage Device Models","color":"grey"},"ev":{}},"Container#1":{"t":"Container","lX":15,"lY":55,"sX":5.95,"sY":1.05,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"25.24%","height":"8.77%","x":"0.46%","y":"4.4%"},"ver":"190104c190915","z":"110","dis":false,"a":{"title":"","color":"white"},"ev":{}},"Label#0":{"t":"Label","lX":30,"lY":80,"sX":1.95,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"8.2%","height":"2.09%","x":"1.3%","y":"5.87%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"<strong>Select</strong> or <strong>Enter </strong><b>Model Name</b>"},"ev":{}},"Label#2":{"t":"Label","lX":40,"lY":340,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"","height":"","x":"","y":""},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Version"},"ev":{}},"Label#3":{"t":"Label","lX":40,"lY":275,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.04%","x":"1.26%","y":"7.9%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Make"},"ev":{}},"Label#4":{"t":"Label","lX":520,"lY":210,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.04%","x":"11.57%","y":"21.21%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Notes"},"ev":{}},"Label#5":{"t":"Label","lX":275,"lY":275,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.08%","x":"11.15%","y":"24.13%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Status"},"ev":{}},"Label#6":{"t":"Label","lX":40,"lY":210,"sX":1.55,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"6.52%","height":"2.04%","x":"22.93%","y":"23.29%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Account / Department"},"ev":{}},"Image#0":{"t":"Image","lX":610,"lY":50,"sX":1.31,"sY":0.86,"s":"Manage Models","ps":{"enabled":"false","scalingType":"","width":"5.51%","height":"7.01%","x":"25.41%","y":"4.05%"},"ver":"190104c190915","dis":false,"a":{"border width":"0","location":"/images/","image":"device.png","maintain aspect ratio":"false"},"ev":{}},"Label#7":{"t":"Label","lX":280,"lY":210,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"5.06%","height":"2.04%","x":"13.35%","y":"20.41%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Application"},"ev":{}},"Container#2":{"t":"Container","lX":15,"lY":155,"sX":7.45,"sY":3.35,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"31.34%","height":"27.87%","x":"0.29%","y":"12.55%"},"ver":"190104c190915","z":"110","dis":false,"a":{"title":"Edit Model Details","color":"grey"},"ev":{}},"Label#9":{"t":"Label","lX":40,"lY":405,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.08%","x":"11.27%","y":"13.73%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Location"},"ev":{}},"Label#17":{"t":"Label","lX":280,"lY":340,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.04%","x":"11.15%","y":"24.13%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Type"},"ev":{}},"Container#6":{"t":"Container","lX":15,"lY":495,"sX":7.45,"sY":2.95,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"31.34%","height":"24.54%","x":"0.21%","y":"39.12%"},"ver":"190104c190915","z":"110","dis":false,"a":{"title":"Edit Model Custom Attributes","color":"grey"},"ev":{}},"Label#18":{"t":"Label","lX":525,"lY":580,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.03%","x":"1.26%","y":"31.78%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Attribute"},"ev":{}},"Label#19":{"t":"Label","lX":15,"lY":885,"sX":2.3,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"9.68%","height":"2.04%","x":"1.47%","y":"52%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Help goes here...."},"ev":{}},"Label#20":{"t":"Label","lX":525,"lY":640,"sX":1.67,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"6.94%","height":"2.04%","x":"21.5%","y":"36.1%"},"ver":"200124c190915","z":"110","dis":false,"a":{"font size":"14","label text":"Default Value"},"ev":{}},"Script#Attribs":{"t":"Scripting","lX":770,"lY":605,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOSCALE","width":"","height":"","x":"","y":""},"ver":"200124c190915","vis":false,"dis":false,"a":{"script type":"javascript","code editor":"//# sourceURL=dynamic-script.js\n/**\n * Description: Manage the template attribs\n * Create Author/Date: Dean Dobson 24/05/20\n * Modified Author/Date: \n * Version: 1.0\n */\n\nvar dbName = \"kinect\";\nvar tableName = \"templates\";\nvar selectedAttrib = \"\";\nvar currAttribs;;\ninitCurrAttribs();\n\nfunction initCurrAttribs() {\n\tcurrAttribs = {};\n\tcurrAttribs.data = {};\n\tcurrAttribs.headers = [\"attribute\", \"value\"];\n\tcurrAttribs.pk = \"attribute\";\n\tcurrAttribs.label = \"sensacollection\";\n}\n\n// Save button pressed\nClientEvents.subscribe(\"AttribSave\", function (value) {\n\tcurrAttribs = Script.getState(\"currAttribs\"); // from record load in main script\n\t//if (currAttribs === null || currAttribs.value === null) {\n\tif (currAttribs === null) {\n\t\tinitCurrAttribs();\n\t} //else {\n\t//\tcurrAttribs = currAttribs.value;\n\t//}\n\tvar formData = Script.getForm(\"attribs\");\n\tvar selectedAttrib = formData[\"TempAttrib\"];\n\tif (typeof selectedAttrib !== \"undefined\" && selectedAttrib !== \"\") {\n\t\tcurrAttribs.data[selectedAttrib] = [selectedAttrib, formData[\"TempValue\"]];\n\t\tClientEvents.publish(\"TempAttribsDelRows\",\"\");\n\t\tClientEvents.publish(\"TempAttribsSetValues\",currAttribs);\n\t\t//ClientEvents.publish(\"currAttribs\", currAttribs); // Share with main script\n\t\tScript.setState(\"currAttribs\", currAttribs); // Share with main script\n\t\tSystem.status(\"Attribute '\" + selectedAttrib + \"' added.\");\n\t} else {\n\t\tSystem.invokeModal(\"OK\",\"Update Key\", \"No attribute has been updated due to no key entered.\");\n\t}\n});\n\n// Row in table selected event\nClientEvents.subscribe(\"SelectedAttrib\", function (selected) {\n\tselectedAttrib = Object.keys(selected.value.data)[0];\n\tClientEvents.publish(\"KeySetValue\", selectedAttrib);\n\tClientEvents.publish(\"ValueSetValue\", selected.value.data[selectedAttrib][1]);\n});\n\n// Delete button\nClientEvents.subscribe(\"AttribDelete\", function () {\n\t//currAttribs = Script.getState(\"currAttribs\").value;\n\tcurrAttribs = Script.getState(\"currAttribs\");\n\tvar formData = Script.getForm(\"attribs\");\n\tselectedAttrib = formData[\"TempAttrib\"];\n\tif (!(selectedAttrib in currAttribs.data)) {\n\t\tvar delKey = selectedAttrib;\n\t\tif (delKey === \"\") {\n\t\t\tdelKey = \"[nothing]\";\n\t\t}\n\t\tSystem.invokeModal(\"OK\",\"Delete Key\", \"The key '\" + delKey + \"' does not exist as a custom attribute. Check key and try again\");\n\t} else {\n\t\tdelete currAttribs.data[selectedAttrib];\n\t\tClientEvents.publish(\"TempAttribsDelRows\",\"\");\n\t\tClientEvents.publish(\"TempAttribsSetValues\",currAttribs);\n\t\t//ClientEvents.publish(\"currAttribs\", currAttribs);\n\t\tScript.setState(\"currAttribs\", currAttribs);\n\t\tSystem.status(\"Attribute '\" + selectedAttrib + \"' deleted.\", \"IMPORTANT\");\n\t}\n});"},"ev":{"clientEvents":{"inputEvents":{"EventButton":{"channel":"ButAttrib/receive value","event":"receive value"}}},"serverEvents":{"inputEvents":{"DBResult":{"channel":"$DB/ADMIN/MANAGE/RESPONSE","event":"feed"}}}}},"Label#21":{"t":"Label","lX":280,"lY":405,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.04%","x":"11.74%","y":"33.17%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Owner"},"ev":{}},"Button#3":{"t":"Button","lX":635,"lY":420,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"3.75%","x":"19.98%","y":"6.66%"},"ver":"190104c190915","dis":false,"a":{"button name":"Picture","color":"black","value on":"delete"},"ev":{"clientEvents":{"outputEvents":{"Pressed":{"channel":"ModelImgUpload/receive value","event":"pressed","trigger":"pressed"}}}}},"ScriptManage":{"t":"Scripting","lX":780,"lY":40,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOSCALE","width":"4.21%","height":"8.15%","x":"32.73%","y":"3.26%"},"ver":"200124c190915","vis":false,"dis":false,"a":{"script type":"javascript","code editor":"//# sourceURL=dynamic-script.js\n/**\n * Description: Manage the template data\n * Create Author/Date: Dean Dobson 24/05/20\n * Modified Author/Date:\n * Version: 1.0\n */\n\n//TODO: get distributor name\n\nvar dbName = \"kinect\";\nvar tableName = \"_models\";\nvar selectedRec = \"\";\nvar currList = [];\nvar dirty = false;\n\n/**\n * Initialise script state (run once at startup)\n */\nScript.on('load', function() {\n\t// Get the model names\n\tDatabase.readRecords(dbName, tableName, \"model\", \"\", \"ORDER BY model COLLATE NOCASE ASC\");\n\t// TODO Get the account names\n});\n\n// New model selected\nClientEvents.subscribe(\"ModelSelected\", function (selected) {\n\tDatabase.readRecords(dbName, tableName,\"*\",\"model='\" + selected.value + \"'\");\n\tClientEvents.publish(\"currAttribs\",null); // clear attrib global\n});\n\n// Save button\nClientEvents.subscribe(\"ModelSave\", function (value) {\n\t// Get values in form\n\tvar formData = Script.getForm(\"devtemplate\");\n\tselectedRec = formData[\"TempModels\"];\n\tsaveRecs(formData);\n});\n\n// Delete button\nClientEvents.subscribe(\"ModelDelete\", function (value) {\n\t// Get values in form\n\tvar formData = Script.getForm(\"devtemplate\");\n\tselectedRec = formData[\"TempModels\"];\n\tif (formData[\"TempModels\"] !== \"\") {\n\t\tSystem.status(\"Deleting model '\" + selectedRec + \"'...\", \"IMPORTANT\");\n\t\tSystem.invokeModal(\"OK\",\"Confirm Delete\", \"Please confirm that you want to delete model '\"+ selectedRec + \"'. <br><br>NOTE - All devices associated with the model will also be deleted. Are you sure?\", \"Delete\", \"DELETE\", selectedRec);\n\t} else {\n\t\tSystem.status(\"WARNING - Can't perform model delete, no model selected, select a model name and try again....\", \"IMPORTANT\");\n\t}\n});\n\n// Callback from modal with results of user input\nScript.on(\"modal\", function (confirm, source, result, func) {\n\tswitch (func) {\n\t\tcase \"DELETE\":\n\t\t\tif (confirm) {\n\t\t\t\tDatabase.deleteRecord(dbName, tableName, \"model\", selectedRec);\n\t\t\t}\n\t\tbreak;\n\t}\n});\n\n/**\n * Response to message from server channel\n */\nScript.on('server', function(eventData) {\n\t\tswitch (eventData.usrmeta.func) {\n            case \"CREATETABLE\":\n                switch (eventData.value) {\n                    case -1:\n                        System.invokeModal(\"OK\",\"Create Model Template\",\"Error occured when creating a new model table '\" + selectedRec + \"' in the database.\");\n                        break;\n                    case 0:\n                        System.invokeModal(\"OK\",\"Create Model Template\",\"Table '\" + selectedRec + \"' already exists in the database, any existing records in the table will be accessible.\");\n                        break;\n                    case 1:\n                        System.status(\"Device model template '\" + selectedRec + \"' created.\");\n                        break;\n                }\n                break;\n                \n\t\t\tcase \"READRECS\":\n\t\t\t\t// Result of initial load, populate dropdown with all the templates\n\t\t\t\tif (eventData.usrmeta.columns === \"model\") {\n\t\t\t\t\tvar models = Object.keys(eventData.value.data);\n\t\t\t\t\tClientEvents.publish(\"ModelNameList\", models);    // Update the model name dropdown\n\t\t\t\t\tcurrList = models.slice();\n\t\t\t\t}\n\t\t\t\t// Populate a selected template based on the initial value\n\t\t\t\tif (eventData.usrmeta.columns === \"*\" && eventData.usrmeta.filter != \"\") {\n\t\t\t\t\tvar retData = eventData.value.data;\n\t\t\t\t\tObject.keys(retData).forEach(function (item) {\n\t\t\t\t\t\tpopulateFields(retData[item]);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"SAVERECS\":\n\t\t\t\tif (eventData.value > 0) {\n\t\t\t\t\tSystem.status(\"Device template '\" + selectedRec + \"' saved.\");\n\t\t\t\t\tif (currList.indexOf(selectedRec) === -1) {\n\t\t\t\t\t\t// Add the new record to the dropdown list\n\t\t\t\t\t\tClientEvents.publish(\"ModelAddList\",selectedRec);\n\t\t\t\t\t\tcurrList.push(selectedRec);\n\t\t\t\t\t\t// Create a new table for the model only if its new (not modified)\n\t\t\t\t\t\tDatabase.createTable(dbName, selectedRec, \"'serialnum' TEXT NOT NULL UNIQUE COLLATE NOCASE,'name' TEXT COLLATE NOCASE,'type' TEXT COLLATE NOCASE,\" +\n\t\t\t\t\t\t\t\"'application' TEXT COLLATE NOCASE,'make' TEXT COLLATE NOCASE,'version' TEXT,'lastserviced' TEXT,'location' TEXT COLLATE NOCASE,\" + \n\t\t\t\t\t\t\t\"'status' NUMERIC NOT NULL DEFAULT 0,'account' TEXT COLLATE NOCASE,'owner' TEXT COLLATE NOCASE,'notes' TEXT,'lastseen' NUMERIC DEFAULT 0,\" +\n\t\t\t\t\t\t\t\"'lastvalue' TEXT,'connections' NUMERIC DEFAULT 0,'whenadded' NUMERIC DEFAULT 0,'whoadded' TEXT COLLATE NOCASE,'whenmodified' NUMERIC DEFAULT 0,\" +\n\t\t\t\t\t\t\t\"'whomodified' TEXT COLLATE NOCASE,'whendisabled' NUMERIC DEFAULT 0,'whodisabled' TEXT COLLATE NOCASE,'whenenabled' NUMERIC DEFAULT 0,\" +\n\t\t\t\t\t\t\t\"'whoenabled' TEXT COLLATE NOCASE,'attribs' TEXT COLLATE NOCASE,PRIMARY KEY('serialnum')\");\n\t\t\t\t\t\t//TODO: Create index on name, application, account, status\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tSystem.invokeModal(\"OK\",\"Save Record\", \"Device template '\" + selectedRec + \"' didn't save correctly. Please check input.\");\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"DELETEREC\":\n\t\t\t\tif (eventData.value > 0) {\n\t\t\t\t\tSystem.status(\"Device template '\" + selectedRec + \"' deleted.\");\n\t\t\t\t\t// refresh the dropdown & the fields\n\t\t\t\t\tDatabase.readRecords(dbName, tableName, \"model\", \"\", \"ORDER BY model COLLATE NOCASE ASC\");\n\t\t\t\t\t//TODO: Delete the model table from the database\n\t\t\t\t} else {\n\t\t\t\t\tSystem.invokeModal(\"OK\",\"Delete Record\", \"Device template '\" + selectedRec + \"' didn't delete correctly. Please check input.\");\n\t\t\t\t}\n\t\t\t\tbreak;\n        }\n});\n\n// Save form to database\nfunction saveRecs(formData) {\n\tif (formData[\"TempModels\"] !== \"\") {\n\t\tSystem.status(\"Saving device template '\" + selectedRec + \"'...\");\n\t\tvar status = 0;\n\n\t\tswitch (formData[\"TempStatus\"]) {\n\t\t\tcase \"Enabled\":\n\t\t\t\tstatus = 1;\n\t\t\t\tbreak;\n\t\t\tcase \"Inactive\":\n\t\t\t\tstatus = 2;\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Populate a dbRequest object to send to server\n\t\tvar dbRec = {};\n\t\tdbRec.model = formData[\"TempModels\"];\n\t\tdbRec.account = formData[\"TempAccount\"];\n\t\tdbRec.make = formData[\"TempMake\"];\n\t\tdbRec.version = formData[\"TempVersion\"];\n\t\tdbRec.location = formData[\"TempLocation\"];\n\t\tdbRec.application = formData[\"TempApplication\"];\n\t\tdbRec.status = status;\n\t\tdbRec.owner = formData[\"TempOwner\"];\n\t\tdbRec.type = formData[\"TempType\"];\n\t\tdbRec.notes = formData[\"TempNotes\"];\n\t\t// Must save as string and retrieve from statestore\n\t\tdbRec.attribs = JSON.stringify(Script.getState(\"currAttribs\"));\n\t\tvar dbReq = {};\n\t\tdbReq[formData[\"TempModels\"]] = dbRec;\n\t\tDatabase.saveRecord(dbName, tableName, dbReq);\n\t} else {\n\t\tSystem.invokeModal(\"OK\",\"Save Record\", \"NOTE - Can't perform model save, no model selected, select or enter a model name and try again....\");\n\t}\n}\n\n// populate the widget fields from data returned from server\nfunction populateFields(coll) {\n\tClientEvents.publish(\"ApplicationSetValue\",coll[1]);\n\tClientEvents.publish(\"MakeSetValue\",coll[2]);\n\tClientEvents.publish(\"VersionSetValue\",coll[3]);\n\tClientEvents.publish(\"LocationSetValue\",coll[4]);\n\tswitch (coll[5]) {   // Status\n\t\tcase \"0\":\n\t\t\tClientEvents.publish(\"StatusSetValue\",\"Disabled\");\n\t\t\tbreak;\n\t\tcase \"1\":\n\t\t\tClientEvents.publish(\"StatusSetValue\",\"Enabled\");\n\t\t\tbreak;\n\t\tcase \"2\":\n\t\t\tClientEvents.publish(\"StatusSetValue\",\"Inactive\");\n\t\t\tbreak;\n\t}\n\tClientEvents.publish(\"AccountSetValue\",coll[6]);\n\tClientEvents.publish(\"NotesSetValue\",coll[7]);\n\tClientEvents.publish(\"OwnerSetValue\",coll[8]);\n\tClientEvents.publish(\"TypeSetValue\",coll[9]);\n\tClientEvents.publish(\"AttribsDelAll\",\"\");\n\tClientEvents.publish(\"KeySetValue\",\"\");\n\tClientEvents.publish(\"ValueSetValue\",\"\");\n\tClientEvents.publish(\"TempAttribsDelRows\",\"\");\n\tif (coll[10] !== \"null\" && coll[10] !== \"\") { // Custom attribs\n\t\tvar currAttribs = JSON.parse(coll[10]);\n\t\t//if (currAttribs && currAttribs.value) {\n\t\tif (currAttribs) {\n\t\t\t//ClientEvents.publish(\"TempAttribsSetValues\",currAttribs.value);\n\t\t\tClientEvents.publish(\"TempAttribsSetValues\",currAttribs);\n\t\t\t//Script.setState(\"currAttribs\",currAttribs.value); // Save to statestore for attrib script\n\t\t\tScript.setState(\"currAttribs\",currAttribs); // Save to statestore for attrib script\n\t\t}\n\t}\n}"},"ev":{"clientEvents":{"inputEvents":{}},"serverEvents":{"inputEvents":{"DBResult":{"channel":"$DB/ADMIN/MANAGE/RESPONSE","event":"feed"}}}}},"TempAccount":{"t":"Dropdown","lX":30,"lY":225,"sX":2.2,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.26%","height":"3.26%","x":"0.63%","y":"14.98%"},"ver":"190104c190915","dis":false,"tt":"Select default Account or Department to assign device to","a":{"color":"grey","default options":"Unassigned,BCC,ICC","form id":"devtemplate","tab index":"2","default value":"Unassigned"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/reset default","event":"reset default"},"setValue":{"channel":"AccountSetValue/receive value","event":"receive value"}}}}},"TempMake":{"t":"Input","lX":30,"lY":290,"sX":2.3,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.68%","height":"3.33%","x":"1.3%","y":"23.63%"},"ver":"190104c190915","dis":false,"tt":"Device manufacturer (optional).","a":{"color":"grey","form id":"devtemplate","invalid message":"","tab index":"3"},"ev":{"clientEvents":{"inputEvents":{"SetValue":{"channel":"MakeSetValue/receive value","event":"receive value"},"EventClear":{"channel":"clear/receive value","event":"receive value"}},"outputEvents":{}}}},"TempVersion":{"t":"Input","lX":30,"lY":355,"sX":2.3,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.63%","height":"3.26%","x":"0.63%","y":"25.62%"},"ver":"190104c190915","dis":false,"tt":"Model version number (optional)","a":{"color":"grey","form id":"devtemplate","invalid message":"","tab index":"4"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/receive value","event":"receive value"},"setValue":{"channel":"VersionSetValue/receive value","event":"receive value"}}}}},"TempLocation":{"t":"Input","lX":30,"lY":420,"sX":2.3,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.68%","height":"3.24%","x":"25.64%","y":"18.35%"},"ver":"190104c190915","dis":false,"tt":"Default device location (optional)","a":{"color":"grey","form id":"devtemplate","tab index":"5"},"ev":{"clientEvents":{"inputEvents":{"setValue":{"channel":"LocationSetValue/receive value","event":"receive value"},"EventClear":{"channel":"clear/receive value","event":"receive value"}}}}},"TempApplication":{"t":"Input","lX":270,"lY":225,"sX":2.27,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOVERT","width":"11.48%","height":"3.26%","x":"12.09%","y":"21.4%"},"ver":"190104c190915","dis":false,"pr":"Default application name using the devices (optional)","tt":"Default application name using the devices (optional)","a":{"color":"grey","form id":"devtemplate","tab index":"6"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/receive value","event":"receive value"},"setValue":{"channel":"ApplicationSetValue/receive value","event":"receive value"}}}}},"TempStatus":{"t":"Dropdown","lX":270,"lY":290,"sX":2.2,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOVERT","width":"11.13%","height":"3.26%","x":"22.31%","y":"28.11%"},"ver":"190104c190915","dis":false,"tt":"Select default status of device. Device isn't active until enabled.","a":{"default value":"Disabled","default options":"Disabled,Enabled,Inactive","color":"grey","form id":"devtemplate","tab index":"7"},"ev":{"clientEvents":{"inputEvents":{"eventClear":{"channel":"default/reset default","event":"reset default"},"setValue":{"channel":"StatusSetValue/receive value","event":"receive value"}}}}},"TempType":{"t":"Input","lX":270,"lY":355,"sX":2.27,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOVERT","width":"11.48%","height":"3.26%","x":"12.09%","y":"21.4%"},"ver":"190104c190915","dis":false,"tt":"Context of device data (eg. temperature sensor, web service weather forecast)","a":{"color":"grey","form id":"devtemplate","tab index":"8"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/receive value","event":"receive value"},"setValue":{"channel":"TypeSetValue/receive value","event":"receive value"}}}}},"TempOwner":{"t":"Input","lX":270,"lY":420,"sX":2.27,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.47%","height":"3.26%","x":"25.64%","y":"18.35%"},"ver":"190104c190915","dis":false,"tt":"Default owner of the device","a":{"color":"grey","form id":"devtemplate","tab index":"9"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/receive value","event":"receive value"},"setValue":{"channel":"OwnerSetValue/receive value","event":"receive value"}}}}},"TempNotes":{"t":"Text Area","lX":510,"lY":225,"sX":2.27,"sY":1.1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"9.55%","height":"8.96%","x":"21.03%","y":"18.5%"},"ver":"190104c190915","dis":false,"a":{"color":"grey","form id":"devtemplate","tab index":"10"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/receive value","event":"receive value"},"setValue":{"channel":"NotesSetValue/receive value","event":"receive value"}}}}},"TempImage":{"t":"Image","lX":515,"lY":360,"sX":1.06,"sY":1.06,"s":"Manage Models","ps":{"enabled":"false","scalingType":"","width":"4.46%","height":"8.64%","x":"21.29%","y":"23.91%"},"ver":"202605c190915","dis":false,"a":{"border width":"1"},"ev":{"clientEvents":{"inputEvents":{"Load Image":{"channel":"LoadImage/set image","event":"set image"}}}}},"TempModels":{"t":"Dropdown","lX":25,"lY":95,"sX":2.2,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOVERT","width":"11.13%","height":"3.59%","x":"0.76%","y":"7.61%"},"ver":"190104c190915","dis":false,"tt":"Select existing model template (for edit) or enter template name (for new)","a":{"default options":"","placeholder":"No records","disable edit":"false","disable spellcheck":"true","color":"grey","form id":"devtemplate","tab index":"1","fire on load":"true"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/receive value","event":"receive value"},"dbResult":{"channel":"ModelNameList/receive list","event":"receive list"},"Add to list":{"channel":"ModelAddList/append list","event":"append list"}},"outputEvents":{"selectedItem":{"channel":"ModelSelected/receive value","event":"selected","trigger":"selected"}}}}},"TempClear":{"t":"Button","lX":260,"lY":90,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"3.73%","x":"10.73%","y":"6.66%"},"ver":"190104c190915","dis":false,"a":{"button name":"Clear","color":"black","value on":""},"ev":{"clientEvents":{"outputEvents":{"EventDefault":{"channel":"default/reset default","event":"pressed","trigger":"pressed"},"eventClear":{"channel":"clear/receive value","event":"pressed","trigger":"pressed"}}}}},"TempAttrib":{"t":"Input","lX":515,"lY":595,"sX":2.3,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.68%","height":"3.24%","x":"0.72%","y":"17.22%"},"ver":"190104c190915","dis":false,"tt":"testing","a":{"color":"grey","form id":"attribs","invalid message":"","tab index":"11"},"ev":{"clientEvents":{"inputEvents":{"setValue":{"channel":"KeySetValue/receive value","event":"receive value"},"EventClear":{"channel":"clear/receive value","event":"receive value"}}}}},"TempValue":{"t":"Input","lX":515,"lY":655,"sX":2.3,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.68%","height":"3.34%","x":"10.9%","y":"33.09%"},"ver":"190104c190915","dis":false,"tt":"testing","a":{"color":"grey","form id":"attribs","invalid message":"","tab index":"12"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/receive value","event":"receive value"},"setValue":{"channel":"ValueSetValue/receive value","event":"receive value"}}}}},"TempSaveModel":{"t":"Button","lX":375,"lY":90,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"3.75%","x":"15.36%","y":"6.66%"},"ver":"190104c190915","dis":false,"a":{"button name":"Save","color":"black","value on":"save"},"ev":{"clientEvents":{"outputEvents":{"EventSave":{"channel":"ModelSave/receive value","event":"pressed","trigger":"pressed"}}}}},"TempSaveAttrib":{"t":"Button","lX":520,"lY":725,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"3.75%","x":"15.36%","y":"6.66%"},"ver":"190104c190915","dis":false,"a":{"button name":"Save","color":"black","value on":"save"},"ev":{"clientEvents":{"outputEvents":{"Pressed":{"channel":"AttribSave/receive value","event":"pressed","trigger":"pressed"}}}}},"TempDelAttrib":{"t":"Button","lX":645,"lY":725,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"3.75%","x":"19.98%","y":"6.66%"},"ver":"190104c190915","dis":false,"a":{"button name":"Delete","color":"orange strong","value on":"delete"},"ev":{"clientEvents":{"outputEvents":{"Pressed":{"channel":"AttribDelete/receive value","event":"pressed","trigger":"pressed"}}}}},"TempDelModel":{"t":"Button","lX":490,"lY":90,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"3.83%","x":"19.98%","y":"6.66%"},"ver":"190104c190915","dis":false,"a":{"button name":"Delete","color":"orange strong","value on":"delete"},"ev":{"clientEvents":{"outputEvents":{"EventDelete":{"channel":"ModelDelete/receive value","event":"pressed","trigger":"pressed"}}}}},"Button#0":{"t":"Button","lX":635,"lY":360,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"3.75%","x":"19.98%","y":"6.66%"},"ver":"190104c190915","dis":false,"a":{"button name":"Firmware","color":"black","value on":"delete"},"ev":{"clientEvents":{"outputEvents":{"Pressed":{"channel":"ImgUpload/receive value","event":"pressed","trigger":"pressed"}}}}},"Button#1":{"t":"Button","lX":20,"lY":800,"sX":1.35,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"5.68%","height":"3.75%","x":"19.98%","y":"6.66%"},"ver":"190104c190915","dis":false,"a":{"button name":"Bulk Upload","color":"black","value on":"delete"},"ev":{"clientEvents":{"outputEvents":{"Pressed":{"channel":"ImgUpload/receive value","event":"pressed","trigger":"pressed"}}}}},"Scripting#0":{"t":"Scripting","lX":775,"lY":350,"sX":1,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"NOSCALE","width":"","height":"","x":"","y":""},"ver":"200124c190915","vis":false,"dis":false,"a":{"script type":"javascript","code editor":"//# sourceURL=dynamic-script.js\n/**\n * Description: \n * Create Author/Date: \n * Modified Author/Date Date: \n * Version: \n */\n\n/**\n * Initialise script state (run once at startup)\n */\nScript.on('load', function() {\n\n});\n\n// New model selected\nScript.subscribeToState(\"ModelImgUpload\", function (selected) {\n\tSystem.selectFiles(\"image/*\", function (files) {\n\t\t\tdebugger;\n\t\tif (files && files.length !== 0) {\n\t\t\tvar reader = new FileReader();\n            reader.onload = function fileReadCompleted() {\n\t\t\t\tdebugger;\n\t\t\t\tvar fileBlob = reader.result;\n\t\t\t\tScript.setState(\"LoadImage\", fileBlob);\n            };\n            reader.readAsDataURL(files[0]);\n        }\n    });\n});\n\n/**\n * Response to message from server channel\n */\nScript.on('server', function(eventData) {\n\n});"},"ev":{}},"TempAttribs":{"t":"Table","lX":35,"lY":550,"sX":4.6,"sY":2.17,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"19.35%","height":"17.59%","x":"1.43%","y":"37.6%"},"ver":"190104c190915","dis":false,"a":{"text color":"#1c5f5a","row color":"#ffffff","columns":"attribute,value","colWidths":"0.38427947598253276,0.6157205240174672","selectable":"single","color rows":"true"},"ev":{"clientEvents":{"inputEvents":{"DelRows":{"channel":"TempAttribsDelRows/delete all rows","event":"delete all rows"},"AttribsSetValues":{"channel":"TempAttribsSetValues/receive value","event":"receive value"},"EventClear":{"channel":"clear/delete all rows","event":"delete all rows"}},"outputEvents":{"SelectedAttrib":{"channel":"SelectedAttrib/receive value","event":"pressed","trigger":"pressed"}}}}},"Button#2":{"t":"Button","lX":185,"lY":800,"sX":1.35,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"5.68%","height":"3.84%","x":"19.98%","y":"6.66%"},"ver":"190104c190915","dis":false,"a":{"button name":"Generate Token","color":"black","value on":"delete"},"ev":{"clientEvents":{"outputEvents":{"Pressed":{"channel":"ImgUpload/receive value","event":"pressed","trigger":"pressed"}}}}},"Label#27":{"t":"Label","lX":315,"lY":885,"sX":2.3,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"9.68%","height":"2.04%","x":"1.47%","y":"52%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Switch distributors....."},"ev":{}},"Button#4":{"t":"Button","lX":355,"lY":805,"sX":1.35,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"5.68%","height":"3.84%","x":"19.98%","y":"6.66%"},"ver":"190104c190915","dis":false,"a":{"button name":"Setup SIM","color":"black","value on":"delete"},"ev":{"clientEvents":{"outputEvents":{"Pressed":{"channel":"ImgUpload/receive value","event":"pressed","trigger":"pressed"}}}}},"Button#5":{"t":"Button","lX":510,"lY":805,"sX":1.35,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"5.68%","height":"3.84%","x":"19.98%","y":"6.66%"},"ver":"190104c190915","z":"110","dis":false,"a":{"button name":"Cancel SIM","color":"black","value on":"delete"},"ev":{"clientEvents":{"outputEvents":{"Pressed":{"channel":"ImgUpload/receive value","event":"pressed","trigger":"pressed"}}}}},"Button#6":{"t":"Button","lX":520,"lY":870,"sX":1.35,"sY":1,"s":"Manage Models","ps":{"enabled":"false","scalingType":"OK","width":"5.68%","height":"3.84%","x":"19.98%","y":"6.66%"},"ver":"190104c190915","z":"110","dis":false,"a":{"button name":"Lookup IMEI","color":"black","value on":"delete"},"ev":{"clientEvents":{"outputEvents":{"Pressed":{"channel":"ImgUpload/receive value","event":"pressed","trigger":"pressed"}}}}},"Container#3":{"t":"Container","lX":5,"lY":10,"sX":13.2,"sY":11.85,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"56%","height":"96.58%","x":"0.21%","y":"0.83%"},"ver":"190104c190915","z":"110","dis":false,"a":{"color":"grey","title":"Manage Devices"},"ev":{}},"Label#1":{"t":"Label","lX":35,"lY":90,"sX":1.35,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"5.68%","height":"2.04%","x":"1.9%","y":"7.19%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"<strong>Select Model Name</strong>"},"ev":{}},"Container#4":{"t":"Container","lX":20,"lY":65,"sX":6,"sY":1.05,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"25.24%","height":"8.56%","x":"0.81%","y":"5.49%"},"ver":"190104c190915","z":"110","dis":false,"a":{"title":"","color":"white"},"ev":{}},"Container#5":{"t":"Container","lX":20,"lY":175,"sX":7.5,"sY":3.4,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"31.55%","height":"28.29%","x":"0.81%","y":"13.95%"},"ver":"190104c190915","z":"110","dis":false,"a":{"color":"grey","title":"Edit Device Details"},"ev":{}},"Label#8":{"t":"Label","lX":260,"lY":90,"sX":2,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"8.41%","height":"2.04%","x":"1.9%","y":"7.19%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"<strong>Unique Id</strong> (serial number)"},"ev":{}},"Label#10":{"t":"Label","lX":40,"lY":290,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"5.43%","height":"2.09%","x":"1.9%","y":"7.19%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Account"},"ev":{}},"Label#11":{"t":"Label","lX":40,"lY":360,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"5.43%","height":"2.08%","x":"1.9%","y":"7.19%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Make"},"ev":{}},"Label#12":{"t":"Label","lX":35,"lY":430,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.24%","height":"2.09%","x":"1.53%","y":"36.01%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Version"},"ev":{}},"Label#13":{"t":"Label","lX":290,"lY":220,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.08%","x":"12.28%","y":"18.22%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Location"},"ev":{}},"Label#14":{"t":"Label","lX":290,"lY":290,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.08%","x":"12.28%","y":"18.22%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Application"},"ev":{}},"Label#15":{"t":"Label","lX":290,"lY":360,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"5.43%","height":"2.09%","x":"1.9%","y":"7.19%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Status"},"ev":{}},"Label#16":{"t":"Label","lX":290,"lY":430,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.04%","x":"12.28%","y":"18.22%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Type"},"ev":{}},"Script#ManageDev":{"t":"Scripting","lX":1340,"lY":45,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOSCALE","width":"4.21%","height":"8.1%","x":"56.37%","y":"3.65%"},"ver":"200124c190915","vis":false,"dis":false,"a":{"script type":"javascript","code editor":"//# sourceURL=dynamic-script.js\n/**\n * Description: Script to manage Sensahub devices\n * Create Author/Date: Dean Dobson 6/6/20\n * Modified Author/Date: \n * Version: 1.0\n */\n\nvar dbName = \"kinect\";\nvar selectedModel = \"\";\nvar selectedRec = \"\";\nvar currUser = \"Fred\";\nvar selectedAttribKey = \"\";\nvar modelAttribs = \"\"; // Default model attribs\nvar devAttribs = \"\";   // Hold the device attribs\nvar modelDefaults = \"\";\nvar dirty = false;\n\n//TODO: Change dbName when distributor name changes\n//TODO: Dirty flag when there is a change\n//TODO: Need some framework function to pull back current user\n// TODO Get the account names\n\n/**\n * Initialise script state (run once at startup)\n */\nScript.on('load', function() {\n    // Get the model names\n\tDatabase.readRecords(dbName, \"_models\", \"model\", \"\", \"ORDER BY model COLLATE NOCASE ASC\");\n});\n\n// Callback from modal with results of user input\nScript.on(\"modal\", function (confirm, source, result, func) {\n\tswitch (func) {\n\t\tcase \"DELETE\":\n\t\t\tif (confirm) {\n\t\t\t\tDatabase.deleteRecord(dbName, selectedModel, \"serialnum\", selectedRec);\n\t\t\t}\n\t\tbreak;\n\t}\n});\n\n/**\n * Response to message from server channel\n */\nScript.on('server', function(eventData) {\n\t// The models database lookup for just model column for dropdown populating. Callback from screen load.\n\tif (eventData.usrmeta.columns === \"model\") {\t\n\t\tswitch (eventData.usrmeta.func) {\n\t\t\tcase \"READRECS\":\n\t\t\t\t// Result of initial load, populate dropdown with all the templates\n\t\t\t\tvar models = Object.keys(eventData.value.data);\n\t\t\t\tif (models.length === 0) {\n\t\t\t\t\tSystem.status(\"WARNING - There are no models registered, go to the 'Manage Models' screen to initially define a device model template to use for creating Sensahub devices.\", \"IMPORTANT\");\n\t\t\t\t\tSystem.invokeModal(\"OK\",\"No Models Defined\", \"There are no models registered, go to the 'Manage Models' screen to initially create a device model template to use for creating Sensahub devices, then return here to add devices.\");\n\t\t\t\t} else {\n\t\t\t\t\tClientEvents.publish(\"DevRecvModels\", models);    // Update the model name dropdown\n\t\t\t\t}\n\t\t\t\t//TODO: Load the image\n\t\t\t\tbreak;\n        }    \n\t}\n\n\t// The full models database lookup. Callback from selecting a new model.\n\tif (eventData.usrmeta.columns === \"*\" && eventData.usrmeta.dbTable === \"_models\") {\t\n\t\tswitch (eventData.usrmeta.func) {\n\t\t\tcase \"READRECS\":\n\t\t\t\tvar retData = eventData.value.data;\n\t\t\t\tpopulateModelFields(retData[Object.keys(retData)[0]]);\n\t\t\t\t// Load the entire records for the selected model into the table\n\t\t\t\tDatabase.readRecords(dbName, selectedModel, \"*\", \"\", \"ORDER BY serialnum COLLATE NOCASE ASC\");\n\t\t\t\tbreak;\n        }    \n\t}\n\t// The main devices database lookup. Will search for specific models\n\tif (eventData.usrmeta.dbTable === selectedModel) {\n\t\tswitch (eventData.usrmeta.func) {\n\t\t\tcase \"READRECS\":\n                var retData = eventData.value.data;\n                // Populate a selected template based on the initial value\n                if (eventData.usrmeta.columns === \"*\" && eventData.usrmeta.filter != \"\") {\n\t\t\t\t\tpopulateDeviceFields(retData[Object.keys(retData)[0]]);\n\t\t\t\t} else {\n\t\t\t\t\t// Read all records to send to table\n\t\t\t\t\tpopulateTable(eventData.value);\n\t\t\t\t}\n                break;\n\t\t\t\t\n\t\t\tcase \"SAVERECS\":\n\t\t\t\tif (eventData.value > 0) {\n\t\t\t\t\tdirty = false;\n\t\t\t\t\tSystem.status(\"Device '\" + selectedRec + \"' (\" + selectedModel + \") saved.\");\n\t\t\t\t\tClientEvents.publish(\"DevDelAllRows\",\"\");\n\t\t\t\t\tDatabase.readRecords(dbName, selectedModel, \"*\", \"\", \"ORDER BY serialnum COLLATE NOCASE ASC\");\n\t\t\t\t} else {\n\t\t\t\t\tSystem.invokeModal(\"OK\",\"Save Record\", \"Device template '\" + selectedRec + \"' didn't save correctly. Please check input.\");\n\t\t\t\t\tSystem.status(\"WARNING - Device template '\" + selectedRec + \"' didn't save correctly. Please check input.\", \"IMPORTANT\");\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"DELETEREC\":\n\t\t\t\tif (eventData.value > 0) {\n\t\t\t\t\tSystem.status(\"Device template '\" + selectedRec + \"' deleted.\");\n\t\t\t\t\t// refresh the table\n\t\t\t\t\tClientEvents.publish(\"DevDelAllRows\", \"\");\n\t\t\t\t\tDatabase.readRecords(dbName, selectedModel, \"*\", \"\", \"ORDER BY serialnum COLLATE NOCASE ASC\");\n\t\t\t\t} else {\n\t\t\t\t\tSystem.invokeModal(\"OK\",\"Delete Record\", \"Device template '\" + selectedRec + \"' didn't delete correctly. Please check input.\");\n\t\t\t\t\tSystem.status(\"WARNING - Device template '\" + selectedRec + \"' didn't delete correctly. Please check input.\", \"IMPORTANT\");\n\t\t\t\t}\n\t\t\t\tbreak;\n        }\n    }\n});\n\n// Clear button - reset to model defaults\nClientEvents.subscribe(\"DevReset\", function () {\n\tpopulateModelFields(modelDefaults);\n\tClientEvents.publish(\"DevSerialSetVal\",\"\");\n\tClientEvents.publish(\"DevNameSetVal\",\"\");\n\tClientEvents.publish(\"DevLastServicedSetVal\",\"\");\n});\n\n// Save device button\nClientEvents.subscribe(\"DevSave\", function () {\n\tvar formData = Script.getForm(\"DevForm\");\n\tsaveRecs(formData);\n});\n\n// Delete device button \nClientEvents.subscribe(\"DevDetailDelete\", function () {\n\tvar formData = Script.getForm(\"devForm\");\n\tselectedRec = formData[\"DevSerial\"];\n\tif (selectedRec !== \"\") {\n\t\tif (formData[\"DevModel\"] !== \"\") {\n\t\t\tSystem.status(\"Deleting device '\" + selectedRec + \"' (\" + formData[\"DevModel\"] + \")...\", \"IMPORTANT\");\n\t\t\tSystem.invokeModal(\"OK\",\"Confirm Delete\", \"Please confirm that you want to delete device '\"+ selectedRec + \"' (\" + formData[\"DevModel\"] + \").\", \"Delete\", \"DELETE\", selectedRec);\n\t\t} else {\n\t\t\tSystem.status(\"WARNING - Can't perform device delete, no model selected, create a device model template before adding devices...\", \"IMPORTANT\");\n\t\t\tSystem.invokeModal(\"OK\",\"Confirm Delete\", \"Can't perform device delete, no model selected, create a device model template before adding devices.\");\n\t\t}\n\t} else {\n\t\tSystem.status(\"WARNING - Can't perform device delete, no device selected, select a device name from the table and try again....\", \"IMPORTANT\");\n\t\tSystem.invokeModal(\"OK\",\"Confirm Delete\", \"Can't perform device delete, no device selected, select a device name from the table and try again\");\n\t}\n});\n\n// Selected model\nClientEvents.subscribe(\"DevModelSel\", function (selected) {\n\tselectedModel = selected.value;\n\tClientEvents.publish(\"clear\",\"\");\n\tClientEvents.publish(\"DevDelAllRows\", \"\");\n\tDatabase.readRecords(dbName, \"_models\",\"*\",\"model='\" + selectedModel + \"'\");\n});\n\n// Selected device from table\nClientEvents.subscribe(\"DevTableSelected\", function (selected) {\n\tselectedRec = Object.keys(selected.value.data)[0];\n\tDatabase.readRecords(dbName, selectedModel, \"*\", \"serialnum='\" + selectedRec + \"'\");\n\tClientEvents.publish(\"DevSerialSetVal\", selectedRec);\n});\n\n// Attrib save button pressed\nClientEvents.subscribe(\"DevAttribUpdate\", function (value) {\n\tvar formData = Script.getForm(\"AttribForm\");\n\tvar tableAttribs = formData[\"DevAttribs\"];\n\tif (typeof selectedAttribKey !== \"undefined\" && selectedAttribKey !== \"\") {\n\t\ttableAttribs.data[selectedAttribKey] = [selectedAttribKey, formData[\"DevAttribVal\"]];\n\t\tdevAttribs.data[selectedAttribKey] = [selectedAttribKey, formData[\"DevAttribVal\"]];\n\t\tClientEvents.publish(\"DevAttribsSetValues\",tableAttribs);\n\t\tSystem.status(\"Attribute '\" + selectedAttribKey + \"' updated.\");\n\t\tClientEvents.publish(\"DevValueSetVal\", \"\");\n\t\tselectedAttribKey = \"\";   // reset, user has to select another attrib\n\t} else {\n\t\tSystem.invokeModal(\"OK\",\"Update Key\", \"No attribute has been updated due to no attribute being selected. Click on an attribute in the table to select it.\");\n\t}\n});\n\n// Row in attrib table selected event\nClientEvents.subscribe(\"DevAttribSelected\", function (selected) {\n\tselectedAttribKey = Object.keys(selected.value.data)[0];\n\tClientEvents.publish(\"DevValueSetVal\", selected.value.data[selectedAttribKey][1]);\n});\n\n// Main table\nfunction populateTable(collection) {\n\t//TODO: remap column names to more friendly\n\tvar dataClone = JSON.parse(JSON.stringify(collection));\n\tObject.keys(dataClone.data).forEach(function (item) {\n\t\tswitch (dataClone.data[item][8]) {\n\t\t\tcase \"0\":\n\t\t\t\tdataClone.data[item][8] = \"Disabled\";\n\t\t\t\tbreak;\n\t\t\tcase \"1\":\n\t\t\t\tdataClone.data[item][8] = \"Enabled\";\n\t\t\t\tbreak;\n\t\t\tcase \"2\":\n\t\t\t\tdataClone.data[item][8] = \"Inactive\";\n\t\t\t\tbreak;\n\t\t}\n\t\tif (dataClone.data[item][12] == 0) { // last seen\n\t\t\tdataClone.data[item][12] = \"never\";\n\t\t}\n\t});\n\tClientEvents.publish(\"DevSetValues\", dataClone);\n}\n\n// Save form to database\nfunction saveRecs(formData) {\n\tselectedRec = formData[\"DevSerial\"];\n\tif (selectedRec !== \"\") {\n\t\tif (formData[\"DevModels\"] !== \"\") {\n\t\t\tSystem.status(\"Saving device details for '\" + formData[\"DevSerial\"] + \"' (\" + formData[\"DevModel\"] + \")...\");\n\t\t\tvar status = 0;\n\t\t\tswitch (formData[\"DevStatus\"]) {\n\t\t\t\tcase \"Enabled\":\n\t\t\t\t\tstatus = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Inactive\":\n\t\t\t\t\tstatus = 2;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t// Populate a dbRequest object to send to server\n\t\t\tvar dbRec = {};\n\t\t\tdbRec.serialnum = formData[\"DevSerial\"];\n\t\t\tdbRec.name = formData[\"DevName\"];\n\t\t\tdbRec.account = formData[\"DevAccount\"];\n\t\t\tdbRec.make = formData[\"DevMake\"];\n\t\t\tdbRec.version = formData[\"DevVersion\"];\n\t\t\tdbRec.location = formData[\"DevLocation\"];\n\t\t\tdbRec.application = formData[\"DevApplication\"];\n\t\t\tdbRec.lastserviced = formData[\"DevLastServiced\"];\n\t\t\tdbRec.status = status;\n\t\t\tdbRec.owner = formData[\"DevOwner\"];\n\t\t\tdbRec.type = formData[\"DevType\"];\n\t\t\tdbRec.notes = formData[\"DevNotes\"];\n\t\t\tvar modDate = new Date().UTC;\n\t\t\tdbRec.whenmodified = modDate;\n\t\t\tdbRec.whomodified = currUser;\n\t\t\t// Get attribs\n\t\t\tdbRec.attribs = JSON.stringify(devAttribs);\n\t\t\tvar dbReq = {};\n\t\t\tdbReq[formData[\"DevSerial\"]] = dbRec;\n\t\t\tDatabase.saveRecord(dbName, formData[\"DevModel\"], dbReq);\n\t\t} else {\n\t\t\tSystem.status(\"WARNING - No model name specified. Please select a device model name and enter a unique device ID like a serial number.\", \"IMPORTANT\");\n\t\t\tSystem.invokeModal(\"OK\",\"New or Update Device\", \"No model name specified. Please select a device model name and enter a unique device ID like a serial number.\");\t\t\n\t\t}\n\t} else {\n\t\tSystem.status(\"WARNING - No unique ID specified. Please select a device model name and enter a unique device ID like a serial number.\", \"IMPORTANT\");\n\t\tSystem.invokeModal(\"OK\",\"New or Update Device\", \"No unique ID specified. Please select a device model name and enter a unique device ID like a serial number.\");\t\t\n\t}\n}\n\n// populate the widget fields from model data returned from server (when selecting a new device)\nfunction populateModelFields(coll) {\n\tClientEvents.publish(\"DevApplicationSetVal\",coll[1]);\n\tClientEvents.publish(\"DevMakeSetVal\",coll[2]);\n\tClientEvents.publish(\"DevVersionSetVal\",coll[3]);\n\tClientEvents.publish(\"DevLocationSetVal\",coll[4]);\n\tswitch (coll[5]) {   // Status\n\t\tcase \"0\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Disabled\");\n\t\t\tbreak;\n\t\tcase \"1\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Enabled\");\n\t\t\tbreak;\n\t\tcase \"2\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Inactive\");\n\t\t\tbreak;\n\t}\n\tClientEvents.publish(\"DevAccountSetVal\",coll[6]);\n\tClientEvents.publish(\"DevNotesSetVal\",coll[7]);\n\tClientEvents.publish(\"DevOwnerSetVal\",coll[8]);\n\tClientEvents.publish(\"DevTypeSetVal\",coll[9]);\n\tClientEvents.publish(\"DevValueSetVal\",\"\");\n\tif (coll[10] !== \"null\" && coll[10] !== \"\") { // Custom attribs\n\t\tvar currAttribs = JSON.parse(coll[10]);\n\t\tif (currAttribs && currAttribs.value) {\n\t\t\tClientEvents.publish(\"DevAttribsSetValues\",currAttribs.value);\n\t\t\tmodelAttribs = currAttribs.value;\n\t\t}\n\t}\n\tmodelDefaults = coll;\n}\n\n// populate the widget fields from device data returned from server\nfunction populateDeviceFields(coll) {\n\tClientEvents.publish(\"DevNameSetVal\",coll[1]);\n\tClientEvents.publish(\"DevTypeSetVal\",coll[2]);\n\tClientEvents.publish(\"DevApplicationSetVal\",coll[3]);\n\tClientEvents.publish(\"DevMakeSetVal\",coll[4]);\n\tClientEvents.publish(\"DevVersionSetVal\",coll[5]);\n\tClientEvents.publish(\"DevLastServicedSetVal\",coll[6]);\n\tClientEvents.publish(\"DevLocationSetVal\",coll[7]);\n\tswitch (coll[8]) {   // Status\n\t\tcase \"0\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Disabled\");\n\t\t\tbreak;\n\t\tcase \"1\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Enabled\");\n\t\t\tbreak;\n\t\tcase \"2\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Inactive\");\n\t\t\tbreak;\n\t}\n\tvar locale = System.getLocale()\n\tvar date = new Date(+coll[17]).toLocaleDateString(locale);\n\tvar time = new Date(+coll[17]).toLocaleTimeString(locale);\n\tClientEvents.publish(\"DevModSetVal\",date + \" \" + time);\n\t\n\tClientEvents.publish(\"DevAccountSetVal\",coll[9]);\n\tClientEvents.publish(\"DevOwnerSetVal\",coll[10]);\n\tClientEvents.publish(\"DevNotesSetVal\",coll[11]);\n\tClientEvents.publish(\"DeleteAttribs\", \"\");\n\tClientEvents.publish(\"DevAttribsSetValues\",modelAttribs); // Reset to default attribs\n\tif (coll[23] !== \"null\" && coll[23] !== \"\") { // Custom attribs\n\t\tdevAttribs = JSON.parse(coll[23]);\n\t\tClientEvents.publish(\"DevAttribsSetValues\",devAttribs);\n\t}\n}"},"ev":{"clientEvents":{"inputEvents":{"selectedItem":{"channel":"selectedItem/receive value","event":"receive value"},"New":{"channel":"ButNew/receive value","event":"receive value"}}},"serverEvents":{"inputEvents":{"$DB":{"channel":"$DB/ADMIN/MANAGE/RESPONSE","event":"feed"}}}}},"DevAccount":{"t":"Dropdown","lX":30,"lY":305,"sX":2.2,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.26%","height":"3.33%","x":"2.71%","y":"19.86%"},"ver":"190104c190915","dis":false,"tt":"Account device is allocated to","a":{"form id":"DevForm","default options":"Unassigned","color":"grey","placeholder":"Select Account","default value":"Unassigned","tab index":"4"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevAccountSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/reset default","event":"reset default"}}}}},"DevMake":{"t":"Input","lX":30,"lY":375,"sX":2.3,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.68%","height":"3.33%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","dis":false,"tt":"Manufacturer of the device","a":{"tab index":"5","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevMakeSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"DevVersion":{"t":"Input","lX":30,"lY":445,"sX":0.65,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"2.76%","height":"3.34%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","dis":false,"tt":"Device version number","a":{"tab index":"6","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevVersionSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"DevType":{"t":"Input","lX":280,"lY":445,"sX":2.3,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.68%","height":"3.33%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","dis":false,"tt":"Context of incoming data (eg. temperature)","a":{"tab index":"11","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevTypeSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"DevLocation":{"t":"Input","lX":280,"lY":235,"sX":2.3,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.72%","height":"3.33%","x":"11.88%","y":"19.72%"},"ver":"270520c190915","dis":false,"tt":"Where the device is located","a":{"tab index":"8","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevLocationSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"DevApplication":{"t":"Input","lX":280,"lY":305,"sX":2.3,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.68%","height":"3.26%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","dis":false,"tt":"Application using device data","a":{"tab index":"9","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevApplicationSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"DevStatus":{"t":"Dropdown","lX":280,"lY":375,"sX":2.2,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.26%","height":"3.34%","x":"2.71%","y":"19.86%"},"ver":"190104c190915","dis":false,"tt":"Device status. Must be enabled for incoming data to be accepted","a":{"form id":"DevForm","default options":"Disabled,Enabled,Inactive","color":"grey","placeholder":"Select Account","tab index":"10","default value":"Disabled"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevStatusSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/reset default","event":"reset default"}}}}},"Label#22":{"t":"Label","lX":40,"lY":220,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.04%","x":"1.51%","y":"17.28%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Name (alias)"},"ev":{}},"Label#23":{"t":"Label","lX":535,"lY":290,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.04%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Notes"},"ev":{}},"Label#24":{"t":"Label","lX":535,"lY":220,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.08%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Owner"},"ev":{}},"DevOwner":{"t":"Input","lX":525,"lY":235,"sX":2.3,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.68%","height":"3.33%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","dis":false,"tt":"Allocated owner for the device","a":{"tab index":"12","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevOwnerSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"DevUpdate":{"t":"Button","lX":530,"lY":440,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"3.84%","x":"20.7%","y":"9.23%"},"ver":"190104c190915","dis":false,"tt":"Update device details","a":{"button name":"Save","color":"black"},"ev":{"clientEvents":{"outputEvents":{"DevUpdatePress":{"channel":"DevSave/receive value","event":"pressed","trigger":"pressed"}}}}},"DevDelete":{"t":"Button","lX":650,"lY":440,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"3.84%","x":"20.7%","y":"9.23%"},"ver":"190104c190915","dis":false,"tt":"Delete device record","a":{"button name":"Delete","color":"orange strong"},"ev":{"clientEvents":{"outputEvents":{"DevDetailDel":{"channel":"DevDetailDelete/receive value","event":"pressed","trigger":"pressed"}}}}},"DevImage":{"t":"Image","lX":645,"lY":65,"sX":1.01,"sY":1.01,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"","width":"4.25%","height":"8.4%","x":"27.14%","y":"5.57%"},"ver":"202605c190915","dis":false,"a":{"border width":"1"},"ev":{}},"DevSerial":{"t":"Input","lX":250,"lY":105,"sX":2.3,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.68%","height":"3.26%","x":"0.72%","y":"17.22%"},"ver":"190104c190915","dis":false,"tt":"Enter unique ID to identify incoming data","a":{"color":"grey","form id":"DevForm","invalid message":"","tab index":"2"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/receive value","event":"receive value"},"DevSerialSetVal":{"channel":"DevSerialSetVal/receive value","event":"receive value"}}}}},"Container#7":{"t":"Container","lX":770,"lY":65,"sX":5.3,"sY":3.1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"22.3%","height":"25.79%","x":"0.81%","y":"13.95%"},"ver":"190104c190915","z":"110","dis":false,"a":{"color":"grey","title":"Device Statistics"},"ev":{}},"DevNotes":{"t":"Text Area","lX":525,"lY":305,"sX":2.3,"sY":1.1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"9.63%","height":"9.15%","x":"12.59%","y":"21.67%"},"ver":"190104c190915","dis":false,"a":{"color":"grey","form id":"DevForm","tab index":"13"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/receive value","event":"receive value"},"SetVal":{"channel":"DevNotesSetVal/receive value","event":"receive value"}}}}},"DevModel":{"t":"Dropdown","lX":30,"lY":105,"sX":2.05,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"11.12%","height":"3.34%","x":"1.63%","y":"8.88%"},"ver":"190104c190915","dis":false,"tt":"Select device model name","a":{"color":"grey","placeholder":"Select Model","default options":"","fire on load":"true","form id":"DevForm","tab index":"1"},"ev":{"clientEvents":{"inputEvents":{"Receive Models":{"channel":"DevRecvModels/receive list","event":"receive list"}},"outputEvents":{"SelectedItem":{"channel":"DevModelSel/receive value","event":"selected","trigger":"selected"}}}}},"DevName":{"t":"Input","lX":30,"lY":235,"sX":2.3,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.63%","height":"3.33%","x":"1.43%","y":"14.51%"},"ver":"270520c190915","z":"110","dis":false,"tt":"Friendly name or alias for device","a":{"tab index":"3","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevNameSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"Graph#0":{"t":"Graph","lX":785,"lY":235,"sX":2.38,"sY":0.6,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"20.03%","height":"9.98%","x":"33.52%","y":"28.99%"},"ver":"190104c190915","dis":false,"a":{"line type":"linear","history timespan":"12","title":"Connections / Day","x-axis":"days","y-axis":"number"},"ev":{}},"Container#8":{"t":"Container","lX":800,"lY":115,"sX":4.8,"sY":1.1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"19.98%","height":"8.96%","x":"33.66%","y":"9.4%"},"ver":"190104c190915","z":"110","dis":false,"a":{"color":"grey","title":""},"ev":{}},"DevLastSeen":{"t":"Label","lX":815,"lY":125,"sX":2.25,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"9.55%","height":"2.04%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Last Seen: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevLastSeenSetVal":{"channel":"DevLastSeenSetVal/receive value","event":"receive value"}}}}},"DevLastVal":{"t":"Label","lX":815,"lY":155,"sX":2.25,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"9.55%","height":"2.03%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Last Value: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevLastValSetVal":{"channel":"DevLastValSetVal/receive value","event":"receive value"}}}}},"DevTotConn":{"t":"Label","lX":815,"lY":185,"sX":2.25,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"9.55%","height":"2.04%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Total Connections: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevTotConnSetVal":{"channel":"DevTotConnSetVal/receive value","event":"receive value"}}}}},"DevAdded":{"t":"Label","lX":1050,"lY":125,"sX":2.25,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"9.55%","height":"2.03%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","z":"110","dis":false,"a":{"font size":"14","label text":"Added: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevAddedSetVal":{"channel":"DevAddedSetVal/receive value","event":"receive value"}}}}},"DevMod":{"t":"Label","lX":1050,"lY":155,"sX":2.25,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"9.55%","height":"2.03%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","z":"110","dis":false,"a":{"font size":"14","label text":"Modified: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevModSetVal":{"channel":"DevModSetVal/receive value","event":"receive value"}}}}},"DevEnabled":{"t":"Label","lX":1050,"lY":185,"sX":2.25,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"9.55%","height":"2.03%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","z":"110","dis":false,"a":{"font size":"14","label text":"Enabled: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevEnabledSetVal":{"channel":"DevEnabledSetVal/receive value","event":"receive value"}}}}},"DevTable":{"t":"Table","lX":20,"lY":520,"sX":12.75,"sY":6.35,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"54.09%","height":"51.46%","x":"0.85%","y":"41.35%"},"ver":"190104c190915","dis":false,"a":{"text color":"#1c5f5a","columns":"serialnum,name,account,status,application,lastseen","title":"Device List","display header":"true","selectable":"single","enable search":"true","row color":"#000000","colWidths":"0.16732128829536527,0.16653574234092694,0.16653574234092694,0.16653574234092694,0.16653574234092694,0.16653574234092694"},"ev":{"clientEvents":{"inputEvents":{"DevSetValues":{"channel":"DevSetValues/receive value","event":"receive value"},"DeleteAllRows":{"channel":"DevDelAllRows/delete all rows","event":"delete all rows"}},"outputEvents":{"RowSelected":{"channel":"DevTableSelected/receive value","event":"pressed","trigger":"pressed"}}}}},"Container#9":{"t":"Container","lX":1050,"lY":375,"sX":2.5,"sY":1.4,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"10.52%","height":"11.65%","x":"44.05%","y":"31.2%"},"ver":"190104c190915","z":"110","dis":false,"a":{"title":"","color":"grey"},"ev":{}},"Label#25":{"t":"Label","lX":1070,"lY":390,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.08%","x":"44.97%","y":"32.36%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Attribute Value"},"ev":{}},"DevUpdAttrib":{"t":"Button","lX":1180,"lY":455,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"3.75%","x":"20.7%","y":"9.23%"},"ver":"190104c190915","dis":false,"tt":"Update device details","a":{"button name":"Update","color":"black"},"ev":{"clientEvents":{"outputEvents":{"DevUpdatePress":{"channel":"DevAttribUpdate/receive value","event":"pressed","trigger":"pressed"}}}}},"DevClear":{"t":"Button","lX":495,"lY":100,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"3.75%","x":"20.7%","y":"9.23%"},"ver":"190104c190915","dis":false,"tt":"Create new device","a":{"button name":"Clear","color":"black","value on":""},"ev":{"clientEvents":{"outputEvents":{"Pressed":{"channel":"DevReset/receive value","event":"pressed","trigger":"pressed"}}}}},"Label#26":{"t":"Label","lX":100,"lY":430,"sX":1,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"4.21%","height":"2.09%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Last Serviced"},"ev":{}},"DevLastServiced":{"t":"Input","lX":90,"lY":445,"sX":1.7,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"7.21%","height":"3.26%","x":"3.9%","y":"37.18%"},"ver":"270520c190915","dis":false,"tt":"Device version number","a":{"tab index":"7","color":"grey","form id":"DevForm","type":"date"},"ev":{"clientEvents":{"inputEvents":{"Clear":{"channel":"clear/receive value","event":"receive value"},"SetVal":{"channel":"DevLastServicedSetVal/receive value","event":"receive value"}}}}},"DevAttribs":{"t":"Table","lX":770,"lY":375,"sX":2.65,"sY":1.31,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"OK","width":"11.24%","height":"10.68%","x":"32.75%","y":"31.33%"},"ver":"190104c190915","dis":false,"a":{"text color":"#1c5f5a","row color":"#ffffff","columns":"attribute,value","colWidths":"0.42585551330798476,0.5741444866920152","form id":"AttribForm","selectable":"single","color rows":"true"},"ev":{"clientEvents":{"inputEvents":{"ReceiveValue":{"channel":"DevAttribsSetValues/receive value","event":"receive value"},"DeleteAttribs":{"channel":"DeleteAttribs/delete all rows","event":"delete all rows"}},"outputEvents":{"Selected":{"channel":"DevAttribSelected/receive value","event":"pressed","trigger":"pressed"}}}}},"DevAttribVal":{"t":"Input","lX":1060,"lY":405,"sX":2.22,"sY":1,"s":"Manage Devices","ps":{"enabled":"false","scalingType":"NOVERT","width":"9.26%","height":"3.26%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","z":"110","dis":false,"tt":"Context of incoming data (eg. temperature)","a":{"tab index":"10","color":"grey","form id":"AttribForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevValueSetVal/receive value","event":"receive value"},"EventClear":{"channel":"clear/receive value","event":"receive value"}}}}},"Rose#0":{"t":"Rose","lX":40,"lY":70,"sX":0.98,"sY":0.98,"s":"Rose","ps":{"enabled":"false","scalingType":"OK","width":"26.29%","height":"50.65%","x":"1.72%","y":"5.75%"},"ver":"190104c190915","dis":false,"tt":"","a":{},"ev":{}},"Rain Radar#0":{"t":"Rain Radar","lX":60,"lY":630,"sX":1,"sY":1,"s":"Rose","ps":{"enabled":"false","scalingType":"NOHORIZ,NOVERT","width":"21.62%","height":"48.78%","x":"2.52%","y":"51.05%"},"ver":"190104c190915","dis":false,"a":{"city":"gladstone"},"ev":{}},"Wind Speed#0":{"t":"Wind Speed","lX":620,"lY":1060,"sX":1,"sY":1,"s":"Rose","ps":{"enabled":"false","scalingType":null,"width":"","height":"","x":"","y":""},"ver":"190104c190915","a":{"ratio":"1"},"ev":{}},"Gauge#0":{"t":"Gauge","lX":640,"lY":880,"sX":1,"sY":1,"s":"Rose","ps":{"enabled":"false","scalingType":null,"width":"","height":"","x":"","y":""},"ver":"190826c190915","a":{"title":"Engine","units":"RPM","min":"0","max":"100","red threshold":"100","yellow threshold":"75","green threshold":"50","lower bound":"0"},"ev":{}},"Container#10":{"t":"Container","lX":10,"lY":0,"sX":13.2,"sY":13.75,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"75.99%","height":"167.68%","x":"0.75%","y":"0%"},"ver":"190104c190915","z":"110","dis":false,"a":{"color":"grey","title":"Manage Devices"},"ev":{}},"Label#28":{"t":"Label","lX":30,"lY":80,"sX":1.35,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"5.68%","height":"2.04%","x":"1.9%","y":"7.19%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"<strong>Select Model Name</strong>"},"ev":{}},"Container#11":{"t":"Container","lX":20,"lY":65,"sX":7.4,"sY":1.05,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"42.6%","height":"12.8%","x":"0.81%","y":"5.49%"},"ver":"190104c190915","z":"110","dis":false,"a":{"title":"","color":"white"},"ev":{}},"Container#12":{"t":"Container","lX":20,"lY":175,"sX":7.5,"sY":4.75,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"43.18%","height":"57.93%","x":"0.81%","y":"13.95%"},"ver":"190104c190915","z":"110","dis":false,"a":{"color":"grey","title":"Edit Device Details"},"ev":{}},"Label#29":{"t":"Label","lX":295,"lY":85,"sX":2,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"8.41%","height":"2.04%","x":"1.9%","y":"7.19%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"<strong>Unique Id</strong> (serial number)"},"ev":{}},"Label#30":{"t":"Label","lX":40,"lY":290,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"5.43%","height":"2.09%","x":"1.9%","y":"7.19%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Account"},"ev":{}},"Label#31":{"t":"Label","lX":40,"lY":360,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"5.43%","height":"2.08%","x":"1.9%","y":"7.19%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Make"},"ev":{}},"Label#32":{"t":"Label","lX":35,"lY":430,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.24%","height":"3.74%","x":"1.53%","y":"36.01%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Version"},"ev":{}},"Label#33":{"t":"Label","lX":290,"lY":220,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"2.08%","x":"12.28%","y":"18.22%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Location"},"ev":{}},"Label#34":{"t":"Label","lX":290,"lY":290,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"2.08%","x":"12.28%","y":"18.22%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Application"},"ev":{}},"Label#35":{"t":"Label","lX":290,"lY":360,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"5.43%","height":"2.09%","x":"1.9%","y":"7.19%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Status"},"ev":{}},"Label#36":{"t":"Label","lX":290,"lY":430,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"2.04%","x":"12.28%","y":"18.22%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Type"},"ev":{}},"Scripting#1":{"t":"Scripting","lX":1340,"lY":45,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOSCALE","width":"4.21%","height":"8.1%","x":"56.37%","y":"3.65%"},"ver":"200124c190915","vis":false,"dis":false,"a":{"script type":"javascript","code editor":"//# sourceURL=dynamic-script.js\n/**\n * Description: Script to manage Sensahub devices\n * Create Author/Date: Dean Dobson 6/6/20\n * Modified Author/Date: \n * Version: 1.0\n */\n\nvar dbName = \"kinect\";\nvar selectedModel = \"\";\nvar selectedRec = \"\";\nvar currUser = \"Fred\";\nvar selectedAttribKey = \"\";\nvar modelAttribs = \"\"; // Default model attribs\nvar devAttribs = \"\";   // Hold the device attribs\nvar modelDefaults = \"\";\nvar dirty = false;\n\n//TODO: Change dbName when distributor name changes\n//TODO: Dirty flag when there is a change\n//TODO: Need some framework function to pull back current user\n// TODO Get the account names\n\n/**\n * Initialise script state (run once at startup)\n */\nScript.on('load', function() {\n    // Get the model names\n\tDatabase.readRecords(dbName, \"_models\", \"model\", \"\", \"ORDER BY model COLLATE NOCASE ASC\");\n});\n\n// Callback from modal with results of user input\nScript.on(\"modal\", function (confirm, source, result, func) {\n\tswitch (func) {\n\t\tcase \"DELETE\":\n\t\t\tif (confirm) {\n\t\t\t\tDatabase.deleteRecord(dbName, selectedModel, \"serialnum\", selectedRec);\n\t\t\t}\n\t\tbreak;\n\t}\n});\n\n/**\n * Response to message from server channel\n */\nScript.on('server', function(eventData) {\n\t// The models database lookup for just model column for dropdown populating. Callback from screen load.\n\tif (eventData.usrmeta.columns === \"model\") {\t\n\t\tswitch (eventData.usrmeta.func) {\n\t\t\tcase \"READRECS\":\n\t\t\t\t// Result of initial load, populate dropdown with all the templates\n\t\t\t\tvar models = Object.keys(eventData.value.data);\n\t\t\t\tif (models.length === 0) {\n\t\t\t\t\tSystem.status(\"WARNING - There are no models registered, go to the 'Manage Models' screen to initially define a device model template to use for creating Sensahub devices.\", \"IMPORTANT\");\n\t\t\t\t\tSystem.invokeModal(\"OK\",\"No Models Defined\", \"There are no models registered, go to the 'Manage Models' screen to initially create a device model template to use for creating Sensahub devices, then return here to add devices.\");\n\t\t\t\t} else {\n\t\t\t\t\tClientEvents.publish(\"DevRecvModels\", models);    // Update the model name dropdown\n\t\t\t\t}\n\t\t\t\t//TODO: Load the image\n\t\t\t\tbreak;\n        }    \n\t}\n\n\t// The full models database lookup. Callback from selecting a new model.\n\tif (eventData.usrmeta.columns === \"*\" && eventData.usrmeta.dbTable === \"_models\") {\t\n\t\tswitch (eventData.usrmeta.func) {\n\t\t\tcase \"READRECS\":\n\t\t\t\tvar retData = eventData.value.data;\n\t\t\t\tpopulateModelFields(retData[Object.keys(retData)[0]]);\n\t\t\t\t// Load the entire records for the selected model into the table\n\t\t\t\tDatabase.readRecords(dbName, selectedModel, \"*\", \"\", \"ORDER BY serialnum COLLATE NOCASE ASC\");\n\t\t\t\tbreak;\n        }    \n\t}\n\t// The main devices database lookup. Will search for specific models\n\tif (eventData.usrmeta.dbTable === selectedModel) {\n\t\tswitch (eventData.usrmeta.func) {\n\t\t\tcase \"READRECS\":\n                var retData = eventData.value.data;\n                // Populate a selected template based on the initial value\n                if (eventData.usrmeta.columns === \"*\" && eventData.usrmeta.filter != \"\") {\n\t\t\t\t\tpopulateDeviceFields(retData[Object.keys(retData)[0]]);\n\t\t\t\t} else {\n\t\t\t\t\t// Read all records to send to table\n\t\t\t\t\tpopulateTable(eventData.value);\n\t\t\t\t}\n                break;\n\t\t\t\t\n\t\t\tcase \"SAVERECS\":\n\t\t\t\tif (eventData.value > 0) {\n\t\t\t\t\tdirty = false;\n\t\t\t\t\tSystem.status(\"Device '\" + selectedRec + \"' (\" + selectedModel + \") saved.\");\n\t\t\t\t\tClientEvents.publish(\"DevDelAllRows\",\"\");\n\t\t\t\t\tDatabase.readRecords(dbName, selectedModel, \"*\", \"\", \"ORDER BY serialnum COLLATE NOCASE ASC\");\n\t\t\t\t} else {\n\t\t\t\t\tSystem.invokeModal(\"OK\",\"Save Record\", \"Device template '\" + selectedRec + \"' didn't save correctly. Please check input.\");\n\t\t\t\t\tSystem.status(\"WARNING - Device template '\" + selectedRec + \"' didn't save correctly. Please check input.\", \"IMPORTANT\");\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"DELETEREC\":\n\t\t\t\tif (eventData.value > 0) {\n\t\t\t\t\tSystem.status(\"Device template '\" + selectedRec + \"' deleted.\");\n\t\t\t\t\t// refresh the table\n\t\t\t\t\tClientEvents.publish(\"DevDelAllRows\", \"\");\n\t\t\t\t\tDatabase.readRecords(dbName, selectedModel, \"*\", \"\", \"ORDER BY serialnum COLLATE NOCASE ASC\");\n\t\t\t\t} else {\n\t\t\t\t\tSystem.invokeModal(\"OK\",\"Delete Record\", \"Device template '\" + selectedRec + \"' didn't delete correctly. Please check input.\");\n\t\t\t\t\tSystem.status(\"WARNING - Device template '\" + selectedRec + \"' didn't delete correctly. Please check input.\", \"IMPORTANT\");\n\t\t\t\t}\n\t\t\t\tbreak;\n        }\n    }\n});\n\n// Clear button - reset to model defaults\nClientEvents.subscribe(\"DevReset\", function () {\n\tpopulateModelFields(modelDefaults);\n\tClientEvents.publish(\"DevSerialSetVal\",\"\");\n\tClientEvents.publish(\"DevNameSetVal\",\"\");\n\tClientEvents.publish(\"DevLastServicedSetVal\",\"\");\n});\n\n// Save device button\nClientEvents.subscribe(\"DevSave\", function () {\n\tvar formData = Script.getForm(\"DevForm\");\n\tsaveRecs(formData);\n});\n\n// Delete device button \nClientEvents.subscribe(\"DevDetailDelete\", function () {\n\tvar formData = Script.getForm(\"devForm\");\n\tselectedRec = formData[\"DevSerial\"];\n\tif (selectedRec !== \"\") {\n\t\tif (formData[\"DevModel\"] !== \"\") {\n\t\t\tSystem.status(\"Deleting device '\" + selectedRec + \"' (\" + formData[\"DevModel\"] + \")...\", \"IMPORTANT\");\n\t\t\tSystem.invokeModal(\"OK\",\"Confirm Delete\", \"Please confirm that you want to delete device '\"+ selectedRec + \"' (\" + formData[\"DevModel\"] + \").\", \"Delete\", \"DELETE\", selectedRec);\n\t\t} else {\n\t\t\tSystem.status(\"WARNING - Can't perform device delete, no model selected, create a device model template before adding devices...\", \"IMPORTANT\");\n\t\t\tSystem.invokeModal(\"OK\",\"Confirm Delete\", \"Can't perform device delete, no model selected, create a device model template before adding devices.\");\n\t\t}\n\t} else {\n\t\tSystem.status(\"WARNING - Can't perform device delete, no device selected, select a device name from the table and try again....\", \"IMPORTANT\");\n\t\tSystem.invokeModal(\"OK\",\"Confirm Delete\", \"Can't perform device delete, no device selected, select a device name from the table and try again\");\n\t}\n});\n\n// Selected model\nClientEvents.subscribe(\"DevModelSel\", function (selected) {\n\tselectedModel = selected.value;\n\tClientEvents.publish(\"clear\",\"\");\n\tClientEvents.publish(\"DevDelAllRows\", \"\");\n\tDatabase.readRecords(dbName, \"_models\",\"*\",\"model='\" + selectedModel + \"'\");\n});\n\n// Selected device from table\nClientEvents.subscribe(\"DevTableSelected\", function (selected) {\n\tselectedRec = Object.keys(selected.value.data)[0];\n\tDatabase.readRecords(dbName, selectedModel, \"*\", \"serialnum='\" + selectedRec + \"'\");\n\tClientEvents.publish(\"DevSerialSetVal\", selectedRec);\n});\n\n// Attrib save button pressed\nClientEvents.subscribe(\"DevAttribUpdate\", function (value) {\n\tvar formData = Script.getForm(\"AttribForm\");\n\tvar tableAttribs = formData[\"DevAttribs\"];\n\tif (typeof selectedAttribKey !== \"undefined\" && selectedAttribKey !== \"\") {\n\t\ttableAttribs.data[selectedAttribKey] = [selectedAttribKey, formData[\"DevAttribVal\"]];\n\t\tdevAttribs.data[selectedAttribKey] = [selectedAttribKey, formData[\"DevAttribVal\"]];\n\t\tClientEvents.publish(\"DevAttribsSetValues\",tableAttribs);\n\t\tSystem.status(\"Attribute '\" + selectedAttribKey + \"' updated.\");\n\t\tClientEvents.publish(\"DevValueSetVal\", \"\");\n\t\tselectedAttribKey = \"\";   // reset, user has to select another attrib\n\t} else {\n\t\tSystem.invokeModal(\"OK\",\"Update Key\", \"No attribute has been updated due to no attribute being selected. Click on an attribute in the table to select it.\");\n\t}\n});\n\n// Row in attrib table selected event\nClientEvents.subscribe(\"DevAttribSelected\", function (selected) {\n\tselectedAttribKey = Object.keys(selected.value.data)[0];\n\tClientEvents.publish(\"DevValueSetVal\", selected.value.data[selectedAttribKey][1]);\n});\n\n// Main table\nfunction populateTable(collection) {\n\t//TODO: remap column names to more friendly\n\tvar dataClone = JSON.parse(JSON.stringify(collection));\n\tObject.keys(dataClone.data).forEach(function (item) {\n\t\tswitch (dataClone.data[item][8]) {\n\t\t\tcase \"0\":\n\t\t\t\tdataClone.data[item][8] = \"Disabled\";\n\t\t\t\tbreak;\n\t\t\tcase \"1\":\n\t\t\t\tdataClone.data[item][8] = \"Enabled\";\n\t\t\t\tbreak;\n\t\t\tcase \"2\":\n\t\t\t\tdataClone.data[item][8] = \"Inactive\";\n\t\t\t\tbreak;\n\t\t}\n\t\tif (dataClone.data[item][12] == 0) { // last seen\n\t\t\tdataClone.data[item][12] = \"never\";\n\t\t}\n\t});\n\tClientEvents.publish(\"DevSetValues\", dataClone);\n}\n\n// Save form to database\nfunction saveRecs(formData) {\n\tselectedRec = formData[\"DevSerial\"];\n\tif (selectedRec !== \"\") {\n\t\tif (formData[\"DevModels\"] !== \"\") {\n\t\t\tSystem.status(\"Saving device details for '\" + formData[\"DevSerial\"] + \"' (\" + formData[\"DevModel\"] + \")...\");\n\t\t\tvar status = 0;\n\t\t\tswitch (formData[\"DevStatus\"]) {\n\t\t\t\tcase \"Enabled\":\n\t\t\t\t\tstatus = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Inactive\":\n\t\t\t\t\tstatus = 2;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t// Populate a dbRequest object to send to server\n\t\t\tvar dbRec = {};\n\t\t\tdbRec.serialnum = formData[\"DevSerial\"];\n\t\t\tdbRec.name = formData[\"DevName\"];\n\t\t\tdbRec.account = formData[\"DevAccount\"];\n\t\t\tdbRec.make = formData[\"DevMake\"];\n\t\t\tdbRec.version = formData[\"DevVersion\"];\n\t\t\tdbRec.location = formData[\"DevLocation\"];\n\t\t\tdbRec.application = formData[\"DevApplication\"];\n\t\t\tdbRec.lastserviced = formData[\"DevLastServiced\"];\n\t\t\tdbRec.status = status;\n\t\t\tdbRec.owner = formData[\"DevOwner\"];\n\t\t\tdbRec.type = formData[\"DevType\"];\n\t\t\tdbRec.notes = formData[\"DevNotes\"];\n\t\t\tvar modDate = new Date().UTC;\n\t\t\tdbRec.whenmodified = modDate;\n\t\t\tdbRec.whomodified = currUser;\n\t\t\t// Get attribs\n\t\t\tdbRec.attribs = JSON.stringify(devAttribs);\n\t\t\tvar dbReq = {};\n\t\t\tdbReq[formData[\"DevSerial\"]] = dbRec;\n\t\t\tDatabase.saveRecord(dbName, formData[\"DevModel\"], dbReq);\n\t\t} else {\n\t\t\tSystem.status(\"WARNING - No model name specified. Please select a device model name and enter a unique device ID like a serial number.\", \"IMPORTANT\");\n\t\t\tSystem.invokeModal(\"OK\",\"New or Update Device\", \"No model name specified. Please select a device model name and enter a unique device ID like a serial number.\");\t\t\n\t\t}\n\t} else {\n\t\tSystem.status(\"WARNING - No unique ID specified. Please select a device model name and enter a unique device ID like a serial number.\", \"IMPORTANT\");\n\t\tSystem.invokeModal(\"OK\",\"New or Update Device\", \"No unique ID specified. Please select a device model name and enter a unique device ID like a serial number.\");\t\t\n\t}\n}\n\n// populate the widget fields from model data returned from server (when selecting a new device)\nfunction populateModelFields(coll) {\n\tClientEvents.publish(\"DevApplicationSetVal\",coll[1]);\n\tClientEvents.publish(\"DevMakeSetVal\",coll[2]);\n\tClientEvents.publish(\"DevVersionSetVal\",coll[3]);\n\tClientEvents.publish(\"DevLocationSetVal\",coll[4]);\n\tswitch (coll[5]) {   // Status\n\t\tcase \"0\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Disabled\");\n\t\t\tbreak;\n\t\tcase \"1\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Enabled\");\n\t\t\tbreak;\n\t\tcase \"2\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Inactive\");\n\t\t\tbreak;\n\t}\n\tClientEvents.publish(\"DevAccountSetVal\",coll[6]);\n\tClientEvents.publish(\"DevNotesSetVal\",coll[7]);\n\tClientEvents.publish(\"DevOwnerSetVal\",coll[8]);\n\tClientEvents.publish(\"DevTypeSetVal\",coll[9]);\n\tClientEvents.publish(\"DevValueSetVal\",\"\");\n\tif (coll[10] !== \"null\" && coll[10] !== \"\") { // Custom attribs\n\t\tvar currAttribs = JSON.parse(coll[10]);\n\t\tif (currAttribs && currAttribs.value) {\n\t\t\tClientEvents.publish(\"DevAttribsSetValues\",currAttribs.value);\n\t\t\tmodelAttribs = currAttribs.value;\n\t\t}\n\t}\n\tmodelDefaults = coll;\n}\n\n// populate the widget fields from device data returned from server\nfunction populateDeviceFields(coll) {\n\tClientEvents.publish(\"DevNameSetVal\",coll[1]);\n\tClientEvents.publish(\"DevTypeSetVal\",coll[2]);\n\tClientEvents.publish(\"DevApplicationSetVal\",coll[3]);\n\tClientEvents.publish(\"DevMakeSetVal\",coll[4]);\n\tClientEvents.publish(\"DevVersionSetVal\",coll[5]);\n\tClientEvents.publish(\"DevLastServicedSetVal\",coll[6]);\n\tClientEvents.publish(\"DevLocationSetVal\",coll[7]);\n\tswitch (coll[8]) {   // Status\n\t\tcase \"0\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Disabled\");\n\t\t\tbreak;\n\t\tcase \"1\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Enabled\");\n\t\t\tbreak;\n\t\tcase \"2\":\n\t\t\tClientEvents.publish(\"DevStatusSetVal\",\"Inactive\");\n\t\t\tbreak;\n\t}\n\tvar locale = System.getLocale()\n\tvar date = new Date(+coll[17]).toLocaleDateString(locale);\n\tvar time = new Date(+coll[17]).toLocaleTimeString(locale);\n\tClientEvents.publish(\"DevModSetVal\",date + \" \" + time);\n\t\n\tClientEvents.publish(\"DevAccountSetVal\",coll[9]);\n\tClientEvents.publish(\"DevOwnerSetVal\",coll[10]);\n\tClientEvents.publish(\"DevNotesSetVal\",coll[11]);\n\tClientEvents.publish(\"DeleteAttribs\", \"\");\n\tClientEvents.publish(\"DevAttribsSetValues\",modelAttribs); // Reset to default attribs\n\tif (coll[23] !== \"null\" && coll[23] !== \"\") { // Custom attribs\n\t\tdevAttribs = JSON.parse(coll[23]);\n\t\tClientEvents.publish(\"DevAttribsSetValues\",devAttribs);\n\t}\n}"},"ev":{"clientEvents":{"inputEvents":{"selectedItem":{"channel":"selectedItem/receive value","event":"receive value"},"New":{"channel":"ButNew/receive value","event":"receive value"}}},"serverEvents":{"inputEvents":{"$DB":{"channel":"$DB/ADMIN/MANAGE/RESPONSE","event":"feed"}}}}},"Dropdown#0":{"t":"Dropdown","lX":30,"lY":305,"sX":2.2,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"9.26%","height":"3.33%","x":"2.71%","y":"19.86%"},"ver":"190104c190915","dis":false,"tt":"Account device is allocated to","a":{"form id":"DevForm","default options":"Unassigned","color":"grey","placeholder":"Select Account","default value":"Unassigned","tab index":"4"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevAccountSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/reset default","event":"reset default"}}}}},"Input#0":{"t":"Input","lX":30,"lY":375,"sX":2.3,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"9.68%","height":"3.33%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","dis":false,"tt":"Manufacturer of the device","a":{"tab index":"5","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevMakeSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"Input#1":{"t":"Input","lX":30,"lY":445,"sX":0.65,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"2.76%","height":"3.34%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","dis":false,"tt":"Device version number","a":{"tab index":"6","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevVersionSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"Input#2":{"t":"Input","lX":280,"lY":445,"sX":2.3,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"9.68%","height":"3.33%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","dis":false,"tt":"Context of incoming data (eg. temperature)","a":{"tab index":"11","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevTypeSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"Input#3":{"t":"Input","lX":280,"lY":235,"sX":2.3,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"9.72%","height":"3.33%","x":"11.88%","y":"19.72%"},"ver":"270520c190915","dis":false,"tt":"Where the device is located","a":{"tab index":"8","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevLocationSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"Input#4":{"t":"Input","lX":280,"lY":305,"sX":2.3,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"9.68%","height":"3.26%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","dis":false,"tt":"Application using device data","a":{"tab index":"9","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevApplicationSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"Dropdown#1":{"t":"Dropdown","lX":280,"lY":375,"sX":2.2,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"9.26%","height":"3.34%","x":"2.71%","y":"19.86%"},"ver":"190104c190915","dis":false,"tt":"Device status. Must be enabled for incoming data to be accepted","a":{"form id":"DevForm","default options":"Disabled,Enabled,Inactive","color":"grey","placeholder":"Select Account","tab index":"10","default value":"Disabled"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevStatusSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/reset default","event":"reset default"}}}}},"Label#37":{"t":"Label","lX":40,"lY":220,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"2.04%","x":"1.51%","y":"17.28%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Name (alias)"},"ev":{}},"Label#38":{"t":"Label","lX":290,"lY":505,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"3.05%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Notes"},"ev":{}},"Label#39":{"t":"Label","lX":35,"lY":500,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"2.08%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Owner"},"ev":{}},"Input#5":{"t":"Input","lX":25,"lY":520,"sX":2.3,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"9.68%","height":"3.33%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","dis":false,"tt":"Allocated owner for the device","a":{"tab index":"12","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevOwnerSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"Button#7":{"t":"Button","lX":645,"lY":655,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"5.61%","x":"20.7%","y":"9.23%"},"ver":"190104c190915","dis":false,"tt":"Update device details","a":{"button name":"Save","color":"black"},"ev":{"clientEvents":{"outputEvents":{"DevUpdatePress":{"channel":"DevSave/receive value","event":"pressed","trigger":"pressed"}}}}},"Button#8":{"t":"Button","lX":520,"lY":655,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"3.84%","x":"20.7%","y":"9.23%"},"ver":"190104c190915","dis":false,"tt":"Delete device record","a":{"button name":"Delete","color":"orange strong"},"ev":{"clientEvents":{"outputEvents":{"DevDetailDel":{"channel":"DevDetailDelete/receive value","event":"pressed","trigger":"pressed"}}}}},"Image#1":{"t":"Image","lX":1045,"lY":120,"sX":2.05,"sY":2.05,"s":"Fred mods","ps":{"enabled":false,"scalingType":"","width":"11.8%","height":"25%","x":"77.89%","y":"22.2%"},"ver":"202605c190915","dis":false,"a":{"border width":"1"},"ev":{}},"Input#6":{"t":"Input","lX":290,"lY":105,"sX":3.15,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"18.13%","height":"4.88%","x":"16.75%","y":"12.68%"},"ver":"190104c190915","dis":false,"tt":"Enter unique ID to identify incoming data","a":{"color":"grey","form id":"DevForm","invalid message":"","tab index":"2"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/receive value","event":"receive value"},"DevSerialSetVal":{"channel":"DevSerialSetVal/receive value","event":"receive value"}}}}},"Container#13":{"t":"Container","lX":770,"lY":65,"sX":5.3,"sY":5.8,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"30.51%","height":"70.73%","x":"0.81%","y":"13.95%"},"ver":"190104c190915","z":"110","dis":false,"a":{"color":"white","title":"Device Statistics"},"ev":{}},"Text Area#0":{"t":"Text Area","lX":280,"lY":525,"sX":2.3,"sY":1.11,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"13.24%","height":"13.41%","x":"16.12%","y":"63.9%"},"ver":"190104c190915","dis":false,"a":{"color":"grey","form id":"DevForm","tab index":"13"},"ev":{"clientEvents":{"inputEvents":{"EventClear":{"channel":"clear/receive value","event":"receive value"},"SetVal":{"channel":"DevNotesSetVal/receive value","event":"receive value"}}}}},"Dropdown#2":{"t":"Dropdown","lX":30,"lY":105,"sX":2.45,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"14.1%","height":"4.88%","x":"1.63%","y":"8.88%"},"ver":"190104c190915","dis":false,"tt":"Select device model name","a":{"color":"grey","placeholder":"Select Model","default options":"","fire on load":"true","form id":"DevForm","tab index":"1"},"ev":{"clientEvents":{"inputEvents":{"Receive Models":{"channel":"DevRecvModels/receive list","event":"receive list"}},"outputEvents":{"SelectedItem":{"channel":"DevModelSel/receive value","event":"selected","trigger":"selected"}}}}},"Input#7":{"t":"Input","lX":30,"lY":235,"sX":2.3,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"9.63%","height":"3.33%","x":"1.43%","y":"14.51%"},"ver":"270520c190915","z":"110","dis":false,"tt":"Friendly name or alias for device","a":{"tab index":"3","color":"grey","form id":"DevForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevNameSetVal/receive value","event":"receive value"},"Clear":{"channel":"clear/receive value","event":"receive value"}}}}},"Graph#1":{"t":"Graph","lX":775,"lY":345,"sX":2.38,"sY":1.18,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"27.4%","height":"28.66%","x":"45.25%","y":"54.02%"},"ver":"190104c190915","dis":false,"a":{"line type":"linear","history timespan":"12","title":"Connections / Day","x-axis":"days","y-axis":"number"},"ev":{}},"Container#14":{"t":"Container","lX":800,"lY":115,"sX":2.3,"sY":2.1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"13.24%","height":"25.61%","x":"33.66%","y":"9.4%"},"ver":"190104c190915","z":"110","dis":false,"a":{"color":"grey","title":""},"ev":{}},"Label#40":{"t":"Label","lX":815,"lY":125,"sX":2.25,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"9.55%","height":"2.04%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Last Seen: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevLastSeenSetVal":{"channel":"DevLastSeenSetVal/receive value","event":"receive value"}}}}},"Label#41":{"t":"Label","lX":815,"lY":155,"sX":2.25,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"9.55%","height":"2.03%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Last Value: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevLastValSetVal":{"channel":"DevLastValSetVal/receive value","event":"receive value"}}}}},"Label#42":{"t":"Label","lX":815,"lY":185,"sX":2.25,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"9.55%","height":"2.04%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Total Connections: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevTotConnSetVal":{"channel":"DevTotConnSetVal/receive value","event":"receive value"}}}}},"Label#43":{"t":"Label","lX":815,"lY":210,"sX":2.25,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"9.55%","height":"2.03%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","z":"110","dis":false,"a":{"font size":"14","label text":"Added: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevAddedSetVal":{"channel":"DevAddedSetVal/receive value","event":"receive value"}}}}},"Label#44":{"t":"Label","lX":815,"lY":240,"sX":1.9,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"10.94%","height":"3.05%","x":"46.98%","y":"29.15%"},"ver":"200124c190915","z":"110","dis":false,"a":{"font size":"14","label text":"Modified: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevModSetVal":{"channel":"DevModSetVal/receive value","event":"receive value"}}}}},"Label#45":{"t":"Label","lX":815,"lY":270,"sX":2.25,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"9.55%","height":"2.03%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","z":"110","dis":false,"a":{"font size":"14","label text":"Enabled: <b>[#]</b>"},"ev":{"clientEvents":{"inputEvents":{"DevEnabledSetVal":{"channel":"DevEnabledSetVal/receive value","event":"receive value"}}}}},"Table#0":{"t":"Table","lX":25,"lY":715,"sX":12.75,"sY":6.35,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"54.09%","height":"77.44%","x":"0.85%","y":"41.35%"},"ver":"190104c190915","dis":false,"a":{"text color":"#1c5f5a","columns":"serialnum,name,account,status,application,lastseen","title":"Device List","display header":"true","selectable":"single","enable search":"true","row color":"#000000","colWidths":"0.16732128829536527,0.16653574234092694,0.16653574234092694,0.16653574234092694,0.16653574234092694,0.16653574234092694"},"ev":{"clientEvents":{"inputEvents":{"DevSetValues":{"channel":"DevSetValues/receive value","event":"receive value"},"DeleteAllRows":{"channel":"DevDelAllRows/delete all rows","event":"delete all rows"}},"outputEvents":{"RowSelected":{"channel":"DevTableSelected/receive value","event":"pressed","trigger":"pressed"}}}}},"Container#15":{"t":"Container","lX":520,"lY":500,"sX":2.5,"sY":1.4,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"10.52%","height":"11.65%","x":"44.05%","y":"31.2%"},"ver":"190104c190915","z":"110","dis":false,"a":{"title":"","color":"grey"},"ev":{}},"Label#46":{"t":"Label","lX":540,"lY":510,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"2.08%","x":"44.97%","y":"32.36%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Attribute Value"},"ev":{}},"Button#9":{"t":"Button","lX":645,"lY":575,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"3.75%","x":"20.7%","y":"9.23%"},"ver":"190104c190915","dis":false,"tt":"Update device details","a":{"button name":"Update","color":"black"},"ev":{"clientEvents":{"outputEvents":{"DevUpdatePress":{"channel":"DevAttribUpdate/receive value","event":"pressed","trigger":"pressed"}}}}},"Button#10":{"t":"Button","lX":625,"lY":105,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"3.75%","x":"20.7%","y":"9.23%"},"ver":"190104c190915","dis":false,"tt":"Create new device","a":{"button name":"Clear","color":"black","value on":""},"ev":{"clientEvents":{"outputEvents":{"Pressed":{"channel":"DevReset/receive value","event":"pressed","trigger":"pressed"}}}}},"Label#47":{"t":"Label","lX":100,"lY":430,"sX":1,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"4.21%","height":"2.09%","x":"22.3%","y":"17.77%"},"ver":"200124c190915","dis":false,"a":{"font size":"14","label text":"Last Serviced"},"ev":{}},"Input#8":{"t":"Input","lX":90,"lY":445,"sX":1.7,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"7.21%","height":"3.26%","x":"3.9%","y":"37.18%"},"ver":"270520c190915","dis":false,"tt":"Device version number","a":{"tab index":"7","color":"grey","form id":"DevForm","type":"date"},"ev":{"clientEvents":{"inputEvents":{"Clear":{"channel":"clear/receive value","event":"receive value"},"SetVal":{"channel":"DevLastServicedSetVal/receive value","event":"receive value"}}}}},"Table#1":{"t":"Table","lX":520,"lY":235,"sX":2.25,"sY":2.55,"s":"Fred mods","ps":{"enabled":false,"scalingType":"OK","width":"12.95%","height":"31.1%","x":"54.83%","y":"58.98%"},"ver":"190104c190915","dis":false,"a":{"text color":"#1c5f5a","row color":"#ffffff","columns":"attribute,value","colWidths":"0.4304932735426009,0.5695067264573991","form id":"AttribForm","selectable":"single","color rows":"true"},"ev":{"clientEvents":{"inputEvents":{"ReceiveValue":{"channel":"DevAttribsSetValues/receive value","event":"receive value"},"DeleteAttribs":{"channel":"DeleteAttribs/delete all rows","event":"delete all rows"}},"outputEvents":{"Selected":{"channel":"DevAttribSelected/receive value","event":"pressed","trigger":"pressed"}}}}},"Input#9":{"t":"Input","lX":530,"lY":525,"sX":2.22,"sY":1,"s":"Fred mods","ps":{"enabled":false,"scalingType":"NOVERT","width":"9.26%","height":"3.26%","x":"10.52%","y":"10.9%"},"ver":"270520c190915","z":"110","dis":false,"tt":"Context of incoming data (eg. temperature)","a":{"tab index":"10","color":"grey","form id":"AttribForm"},"ev":{"clientEvents":{"inputEvents":{"SetVal":{"channel":"DevValueSetVal/receive value","event":"receive value"},"EventClear":{"channel":"clear/receive value","event":"receive value"}}}}}},"screens":{"Manage Models":{"index":0,"icon":"important_devices","meta":""},"Manage Devices":{"index":1,"icon":"devices_other","meta":""},"Rose":{"index":2,"icon":"widgets","meta":""},"Fred mods":{"index":3,"icon":"widgets","meta":""}},"meta":""}